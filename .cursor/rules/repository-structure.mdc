---
description: Repository Structure Requirements
globs: *
alwaysApply: false
---
# Repository Structure Requirements

## Root Level - Required Files

### Documentation
- MUST have `README.md` - Main project documentation (use template format)
- MUST have `CONTRIBUTING.md` - Contribution guidelines
- MUST have `SECURITY.md` - Security policy and procedures
- MUST have `CODE_OF_CONDUCT.md` - Code of conduct
- MUST have `LICENSE` - MIT license file

### Configuration
- MUST have `deepgram.toml` - Deepgram CLI configuration
- MUST have `sample.env` - Environment variable template
- MUST have `.gitignore` - Git ignore rules
- MUST have `.npmrc` - pnpm security configuration
- MUST have `.snyk` - Snyk security policy file

### Application Files
- MUST have a main app file: `server.js`, `index.ts`, `index.js`, or `app.js`
- MUST have `package.json` with:
  - `"packageManager": "pnpm@10.0.0"`
  - `"engines": { "node": ">=24.0.0", "pnpm": ">=10.0.0" }`
  - All dependencies pinned to exact versions (no `^` or `~`)
  - Helper scripts: `install:all`, `install:frontend`, `security-check`, `security-check:all`
  - `browserslist` configuration
- MUST have `pnpm-lock.yaml` - pnpm lockfile

### Optional Configuration
- COULD have `Dockerfile` - For containerization
- COULD have `nodemon.json` - Nodemon configuration
- COULD have `.dockerignore` - Docker ignore rules

## Frontend Directory (if applicable)

If project has a web frontend, MUST have `frontend/` directory with:

### Required Frontend Files
- `frontend/package.json` - MUST include all fields:
  - `name`: `@deepgram/[project-name]-html`
  - `version`: `1.0.0`
  - `private`: `true`
  - `description`: "[Project] HTML frontend with Deepgram design system styles"
  - `main`: `index.html`
  - `type`: `module`
  - `scripts`: `dev`, `build`, `preview`
  - `keywords`: Array with relevant keywords
  - `author`: "Deepgram Starter UIs Team"
  - `license`: "MIT"
  - `repository`: With `directory: "frontend"`
  - `engines`: `{ "node": ">=14.0.0" }`
  - `browserslist`: Standard configuration
  - `dependencies`: `{ "@deepgram/styles": "latest" }`
  - `devDependencies`: `{ "vite": "^7.2.2" }`

- `frontend/vite.config.js` - Vite configuration with:
  - Server port configuration
  - `open: false` to prevent auto-opening browser
  - Proxy configuration for backend API

- `frontend/index.html` - Main HTML file
- `frontend/app.js` - Main JavaScript application file
- `frontend/pnpm-lock.yaml` - Frontend lockfile

### Frontend Directory Structure
```
frontend/
├── package.json          (MUST - complete format)
├── vite.config.js        (MUST - with proxy config)
├── index.html            (MUST - main HTML)
├── app.js                (MUST - main JS)
├── pnpm-lock.yaml        (MUST - lockfile)
├── node_modules/         (local only, in .gitignore)
└── dist/                 (build output, in .gitignore)
```

## Files That MUST NOT Exist

- `package-lock.json` - npm lockfile (pnpm project)
- `yarn.lock` - Yarn lockfile (pnpm project)
- `npm-shrinkwrap.json` - npm lockfile (pnpm project)
- `config.js` - Use inline CONFIG object in server.js instead
- Old test files or temporary scripts

## Directory Structure Example

### Minimal Project (No Frontend)
```
project-name/
├── .gitignore
├── .npmrc
├── .snyk
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── LICENSE
├── README.md
├── SECURITY.md
├── deepgram.toml
├── package.json
├── pnpm-lock.yaml
├── sample.env
├── .env (local only, in .gitignore)
├── node_modules/ (local only, in .gitignore)
└── server.js (or index.ts/app.js)
```

### Full Project (With Frontend)
```
project-name/
├── .gitignore
├── .npmrc
├── .snyk
├── CODE_OF_CONDUCT.md
├── CONTRIBUTING.md
├── LICENSE
├── README.md
├── SECURITY.md
├── deepgram.toml
├── package.json
├── pnpm-lock.yaml
├── sample.env
├── .env (local only, in .gitignore)
├── node_modules/ (local only, in .gitignore)
├── server.js
└── frontend/
    ├── package.json
    ├── vite.config.js
    ├── index.html
    ├── app.js
    ├── pnpm-lock.yaml
    ├── node_modules/ (local only)
    └── dist/ (build output)
```

## Configuration File Requirements

### .npmrc
MUST contain:
```
node-linker=pnpm
ignore-scripts=true
enable-pre-post-scripts=false
minimum-release-age=14400
verify-store-integrity=true
trust-policy=strict
strict-peer-dependencies=true
symlink=true
frozen-lockfile=false
```

### .snyk
MUST contain (block-style):
```yaml
version: v1.25.0
ignore:

```

### .gitignore
MUST ignore:
- `node_modules/`
- `frontend/node_modules/`
- `.env` and `.env.*` (except `.env.example`)
- `frontend/dist/`
- `*.log`
- Editor directories (`.vscode/`, `.idea/`)
- OS files (`.DS_Store`, `Thumbs.db`)

## Validation Checklist

- [ ] All required documentation files present
- [ ] `.npmrc` and `.snyk` configured correctly
- [ ] `package.json` has packageManager and engines
- [ ] All dependencies pinned to exact versions
- [ ] Frontend `package.json` has complete format (if applicable)
- [ ] No npm/yarn lockfiles present
- [ ] `pnpm-lock.yaml` exists (root and frontend)
- [ ] No `config.js` file (use inline CONFIG object)
- [ ] `.gitignore` properly configured
- [ ] `deepgram.toml` uses `pnpm run install:all`
